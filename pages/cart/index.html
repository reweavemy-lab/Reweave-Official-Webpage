<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
      <link rel="icon" type="image/x-icon" href="/Users/howiesim/Documents/Reweave Official Webpage/images/Reweave logo.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Your Cart • Reweave</title>
  <link rel="stylesheet" href="../../css/styles.css" />
  <!-- Google Fonts (Poppins) -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <style>
    :root {
      --text: #111;
      --muted: #6b7280;
      --border: #e5e7eb;
      --bg: #fff;
      --bg-soft: #f8fafc;
      --accent: #111; /* understated, Apple-like */
      --success: #2e7d32;
    }
    body { font-family: 'Poppins', system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; color: var(--text); background: var(--bg); }
    .container { max-width: 1100px; margin: 0 auto; padding: 24px; }
    .page-title { font-size: 28px; font-weight: 600; margin: 16px 0 8px; }
    .subtext { color: var(--muted); font-size: 14px; }

    .cart-grid { display: grid; grid-template-columns: 1fr 360px; gap: 32px; margin-top: 24px; }
    @media (max-width: 980px) { .cart-grid { grid-template-columns: 1fr; } }

    /* Items list */
    .items-card { background: var(--bg); border: 1px solid var(--border); border-radius: 12px; }
    .item-row { display: grid; grid-template-columns: 96px 1fr auto; gap: 16px; padding: 16px; align-items: center; border-bottom: 1px solid var(--border); }
    .item-row:last-child { border-bottom: none; }
    .thumb { width: 96px; height: 96px; border-radius: 10px; background: var(--bg-soft); display:flex; align-items:center; justify-content:center; overflow:hidden; }
    .thumb img { width: 100%; height: 100%; object-fit: cover; }
    .item-main h3 { font-size: 16px; margin: 0 0 6px; font-weight: 600; }
    .item-meta { color: var(--muted); font-size: 13px; }
    .qty { display:flex; border:1px solid var(--border); border-radius: 8px; overflow:hidden; }
    .qty button { width: 36px; height: 36px; border: none; background: var(--bg-soft); cursor:pointer; }
    .qty input { width: 46px; text-align:center; border:none; }
    .item-actions { display:flex; gap:12px; align-items:center; }
    .link-muted { color: var(--muted); font-size: 13px; text-decoration: underline; cursor:pointer; }

    /* Upsell */
    .upsell { margin-top: 24px; background: var(--bg); border: 1px solid var(--border); border-radius: 12px; }
    .upsell h3 { font-size: 16px; font-weight: 600; padding: 16px; margin:0; }
    .upsell-grid { display:grid; grid-template-columns: repeat(2, 1fr); gap: 16px; padding: 0 16px 16px; }
    @media (max-width: 540px) { .upsell-grid { grid-template-columns: 1fr; } }
    .upsell-card { border:1px solid var(--border); border-radius: 10px; padding: 12px; display:grid; grid-template-columns: 64px 1fr auto; gap:12px; align-items:center; }
    .upsell-card .thumb { width:64px; height:64px; }
    .btn { display:inline-block; padding:8px 12px; background:#111; color:#fff; border-radius:8px; font-size:13px; cursor:pointer; border: none; }
    .btn.secondary { background:#fff; color:#111; border:1px solid var(--border); }

    /* Summary */
    .summary { position: sticky; top: 24px; background: var(--bg); border: 1px solid var(--border); border-radius: 12px; padding: 16px; height: fit-content; }
    .summary h3 { font-size: 16px; font-weight: 600; margin: 0 0 12px; }
    .summary-row { display:flex; justify-content: space-between; align-items:center; padding: 8px 0; }
    .summary-row.total { border-top:1px solid var(--border); margin-top:8px; padding-top:12px; font-weight:600; }
    .field { display:flex; gap:8px; margin: 8px 0 4px; }
    .field input { flex:1; padding:8px; border:1px solid var(--border); border-radius:8px; }
    .notice { color: var(--muted); font-size: 13px; }
    .savings { color: var(--success); font-size: 12px; }
    .checkout { width:100%; margin-top: 12px; font-weight: 600; padding: 12px; border-radius: 10px; }
  </style>
</head>
<body>
  <!-- Luxury header (standardized) -->
  <header class="luxury-header">
    <div class="header-container">
      <div class="header-left">
        <button class="menu-btn" aria-label="Menu"><i class="fas fa-bars"></i><span>Menu</span></button>
        <button class="search-btn" aria-label="Search"><i class="fas fa-search"></i><span>Search</span></button>
      </div>
      <div class="logo-center"><a href="../../index.html">REWEAVE</a></div>
      <div class="header-right">
        <button class="utility-btn" aria-label="Call Us"><span>Call Us</span></button>
        <button class="utility-btn" aria-label="Wishlist"><i class="fas fa-heart"></i></button>
        <button class="utility-btn" aria-label="Account"><i class="fas fa-user"></i></button>
        <button class="utility-btn cart-btn" aria-label="Cart"><i class="fas fa-shopping-bag"></i><span class="cart-count">0</span></button>
      </div>
    </div>
    <nav class="hidden-nav">
      <div class="nav-content">
        <button class="close-nav" aria-label="Close"><i class="fas fa-times"></i><span>Close</span></button>
        <div class="nav-categories">
          <div class="nav-section">
            <h3>New</h3>
            <ul>
              <li><a href="../shop/index.html">Latest Arrivals</a></li>
              <li><a href="../shop/index.html">Limited Edition</a></li>
            </ul>
          </div>
          <div class="nav-section">
            <h3>Bags and Accessories</h3>
            <ul>
              <li><a href="../shop/index.html">Totes</a></li>
              <li><a href="../shop/index.html">Slings</a></li>
              <li><a href="../shop/index.html">Accessories</a></li>
            </ul>
          </div>
          <div class="nav-section">
            <h3>Collections</h3>
            <ul>
              <li><a href="../shop/index.html">Batik Heritage</a></li>
              <li><a href="../shop/index.html">Artisan Series</a></li>
            </ul>
          </div>
          <div class="nav-section">
            <h3>About</h3>
            <ul>
              <li><a href="../story/index.html">Our Story</a></li>
              <li><a href="../community/index.html">Community</a></li>
              <li><a href="../impact/index.html">Impact</a></li>
              <li><a href="../journal/index.html">Journal</a></li>
            </ul>
          </div>
        </div>
      </div>
    </nav>
  </header>

  <main class="container">
    <h1 class="page-title">Your Cart</h1>
    <p class="subtext">Clean, focused layout with space for add-ons and upsells.</p>

    <div class="cart-grid">
      <!-- Left: Items and Upsell -->
      <section>
        <div class="items-card" id="itemsCard"></div>

        <div class="upsell" id="upsellSection">
          <h3>Recommended add‑ons</h3>
          <div class="upsell-grid" id="upsellGrid"></div>
        </div>
      </section>

      <!-- Right: Summary -->
      <aside class="summary">
        <h3>Order Summary</h3>
        <div class="summary-row"><span>Subtotal</span><span id="subtotal">$0.00</span></div>
        <div class="summary-row"><span>Shipping</span><span id="shipping">$0.00</span></div>
        <div class="summary-row"><span>Estimated tax</span><span id="tax">$0.00</span></div>
        <div class="summary-row"><span>Discounts</span><span id="discounts">-$0.00</span></div>
        <div class="summary-row total"><span>Total</span><span id="total">$0.00</span></div>
        <div class="field"><input id="promoInput" placeholder="Promo code" /><button class="btn secondary" id="applyPromo">Apply</button></div>
        <p class="savings" id="savingsNote"></p>
        <p class="notice">Free shipping on orders over $100. Split payments available at checkout.</p>
        <button class="btn checkout" id="checkoutBtn">Checkout</button>
      </aside>
    </div>
  </main>

  <footer class="luxury-footer">
    <div class="container">
      <div class="footer-grid">
        <div class="footer-column">
          <h4>Help</h4>
          <ul class="footer-links">
            <li><a href="#">Client Advisor: 1800 814 930</a></li>
            <li><a href="#">FAQ</a></li>
            <li><a href="#">Product Care</a></li>
            <li><a href="#">Delivery, Returns & Exchanges</a></li>
            <li><a href="#">Stores</a></li>
          </ul>
        </div>
        <div class="footer-column">
          <h4>Services</h4>
          <ul class="footer-links">
            <li><a href="#">Repairs</a></li>
            <li><a href="#">Personalisation</a></li>
            <li><a href="#">Art of Gifting</a></li>
            <li><a href="#">Download our Apps</a></li>
          </ul>
        </div>
        <div class="footer-column">
          <h4>About Reweave</h4>
          <ul class="footer-links">
            <li><a href="../story/index.html">Fashion & Craft</a></li>
            <li><a href="../culture/index.html">Arts & Culture</a></li>
            <li><a href="../story/index.html">Our Maison</a></li>
            <li><a href="../impact/index.html">Sustainability</a></li>
            <li><a href="../journal/index.html">Latest News</a></li>
            <li><a href="../story/index.html#careers">Careers</a></li>
            <li><a href="../community/index.html">Foundation</a></li>
          </ul>
        </div>
        <div class="footer-column">
          <h4>Connect</h4>
          <ul class="footer-links">
            <li><a href="#">Sign up for emails</a></li>
            <li><a href="#">Follow Us</a></li>
          </ul>
        </div>
      </div>
      <div class="footer-sub">
        <div class="footer-locale">Ship to: <a href="#">Malaysia</a></div>
        <div class="footer-legal">
          <a href="#">Sitemap</a>
          <a href="#">Legal & Privacy</a>
        </div>
      </div>
      <div class="footer-brand">REWEAVE</div>
    </div>
  </footer>

  <!-- Luxury header interactions -->
  <script src="../../script.js"></script>

  <!-- Cart Logic -->
  <script>
    const itemsCard = document.getElementById('itemsCard');
    const upsellGrid = document.getElementById('upsellGrid');
    const subtotalEl = document.getElementById('subtotal');
    const shippingEl = document.getElementById('shipping');
    const taxEl = document.getElementById('tax');
    const discountsEl = document.getElementById('discounts');
    const totalEl = document.getElementById('total');
    const savingsNote = document.getElementById('savingsNote');

    const taxRate = 0.07; // estimate
    const shippingBase = 8.00; // under threshold and no free ship promo
    const freeShipThreshold = 100.00;

    const format = (n) => `$${n.toFixed(2)}`;

    let cart = JSON.parse(localStorage.getItem('cart') || 'null') || [
      { id: 'bag-001', name: 'Reweave Batik Tote', price: 180.00, qty: 1, image: '../../images/Batik Front (WIP).png', options: 'Color: Deep Plum • Size: Medium', addon: false },
      { id: 'bottle-clip', name: 'Bottle Holder Clip', price: 15.00, qty: 1, image: '../../images/Gemini_Generated_Image_mwmxxemwmxxemwmx.png', options: 'Accessory', addon: true }
    ];

    const upsells = [
      { id: 'leather-care', name: 'Leather Care Kit', price: 25.00, image: '../../images/Gemini_Generated_Image_j8e9c1j8e9c1j8e9.png' },
      { id: 'gift-wrap', name: 'Premium Gift Wrap', price: 8.00, image: '../../images/Gemini_Generated_Image_mwmxxemwmxxemwmx.png' },
      { id: 'extended-warranty', name: '2‑Year Protection', price: 19.00, image: '../../images/Batik Front (WIP) (1).png' },
      { id: 'strap-upgrade', name: 'Padded Strap Upgrade', price: 29.00, image: '../../images/Batik Front (WIP).png' }
    ];

    const promos = {
      'SAVE10': { type: 'percent', value: 0.10, label: 'Save 10%' },
      'WELCOME15': { type: 'percent', value: 0.15, label: 'Welcome 15% off' },
      'FREESHIP': { type: 'shipping', value: 0, label: 'Free Shipping' }
    };
    let appliedPromo = null;

    function persist() { localStorage.setItem('cart', JSON.stringify(cart)); }

    function renderItems() {
      itemsCard.innerHTML = '';
      if (!cart.length) {
        itemsCard.innerHTML = '<div class="item-row" style="justify-content:center">Your cart is empty.</div>';
        return;
      }
      cart.forEach((item) => {
        const row = document.createElement('div');
        row.className = 'item-row';
        row.innerHTML = `
          <div class="thumb"><img src="${item.image}" alt="${item.name}"/></div>
          <div class="item-main">
            <h3>${item.name}</h3>
            <div class="item-meta">${item.options || ''} ${item.addon ? '• Add‑on' : ''}</div>
            <div class="item-actions">
              <div class="qty">
                <button aria-label="Decrease" data-id="${item.id}" data-act="dec">−</button>
                <input value="${item.qty}" readonly />
                <button aria-label="Increase" data-id="${item.id}" data-act="inc">+</button>
              </div>
              <span class="link-muted" data-id="${item.id}" data-act="remove">Remove</span>
            </div>
          </div>
          <div style="text-align:right">
            <div style="font-weight:600">${format(item.price)}</div>
            <div class="subtext">Each</div>
          </div>`;
        itemsCard.appendChild(row);
      });

      // wire events
      itemsCard.querySelectorAll('[data-act]').forEach(el => {
        const id = el.getAttribute('data-id');
        const act = el.getAttribute('data-act');
        el.addEventListener('click', () => {
          if (act === 'inc') changeQty(id, +1);
          if (act === 'dec') changeQty(id, -1);
          if (act === 'remove') removeItem(id);
        });
      });
    }

    function changeQty(id, delta) {
      cart = cart.map(i => i.id === id ? { ...i, qty: Math.max(1, i.qty + delta) } : i);
      persist();
      renderItems();
      updateSummary();
    }

    function removeItem(id) {
      cart = cart.filter(i => i.id !== id);
      persist();
      renderItems();
      updateSummary();
    }

    function renderUpsell() {
      upsellGrid.innerHTML = '';
      upsells.forEach(u => {
        const card = document.createElement('div');
        card.className = 'upsell-card';
        card.innerHTML = `
          <div class="thumb"><img src="${u.image}" alt="${u.name}"/></div>
          <div>
            <div style="font-weight:600">${u.name}</div>
            <div class="subtext">${format(u.price)}</div>
          </div>
          <button class="btn" data-upsell="${u.id}">Add</button>`;
        upsellGrid.appendChild(card);
      });
      upsellGrid.querySelectorAll('[data-upsell]').forEach(btn => {
        btn.addEventListener('click', () => {
          const u = upsells.find(x => x.id === btn.getAttribute('data-upsell'));
          const existing = cart.find(i => i.id === u.id);
          if (existing) { existing.qty += 1; }
          else {
            cart.push({ id: u.id, name: u.name, price: u.price, qty: 1, image: u.image, options: 'Accessory', addon: true });
          }
          persist();
          renderItems();
          updateSummary();
        });
      });
    }

    function calcSubtotal() { return cart.reduce((s, i) => s + i.price * i.qty, 0); }

    function calcShipping(subtotal) {
      if (appliedPromo && appliedPromo.type === 'shipping') return 0;
      return subtotal >= freeShipThreshold ? 0 : shippingBase;
    }

    function calcDiscount(subtotal) {
      if (!appliedPromo) return 0;
      if (appliedPromo.type === 'percent') return subtotal * appliedPromo.value;
      return 0;
    }

    function updateSummary() {
      const subtotal = calcSubtotal();
      const discount = calcDiscount(subtotal);
      const shipping = calcShipping(subtotal);
      const taxable = Math.max(0, subtotal - discount);
      const tax = +(taxable * taxRate).toFixed(2);
      const total = taxable + shipping + tax;

      subtotalEl.textContent = format(subtotal);
      discountsEl.textContent = `-${format(discount)}`;
      shippingEl.textContent = format(shipping);
      taxEl.textContent = format(tax);
      totalEl.textContent = format(total);

      if (subtotal < freeShipThreshold && shipping === 0) {
        savingsNote.textContent = 'Free shipping applied';
      } else if (appliedPromo && appliedPromo.type === 'percent') {
        savingsNote.textContent = `${appliedPromo.label} applied`;
      } else { savingsNote.textContent = ''; }
    }

    document.getElementById('applyPromo').addEventListener('click', () => {
      const code = (document.getElementById('promoInput').value || '').trim().toUpperCase();
      if (promos[code]) { appliedPromo = promos[code]; }
      else { appliedPromo = null; savingsNote.textContent = 'Code not recognized'; }
      updateSummary();
    });

    document.getElementById('checkoutBtn').addEventListener('click', () => {
      alert('Checkout flow not wired yet. We can integrate your provider next.');
    });

    // init
    renderItems();
    renderUpsell();
    updateSummary();
  </script>
</body>
</html>