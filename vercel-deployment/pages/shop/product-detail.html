<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Product Detail â€¢ Reweave</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link rel="stylesheet" href="../../../archive/development-files/css/styles.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
  <link rel="dns-prefetch" href="//fonts.googleapis.com">
  <link rel="dns-prefetch" href="//fonts.gstatic.com">
  <link rel="dns-prefetch" href="//cdnjs.cloudflare.com">
</head>
<body>
  <!-- Standardized Header Component for Reweave -->
<header class="header">
  <div class="header-container">
    <div class="nav-left">
      <button class="nav-btn" onclick="toggleMenu()">
        <i class="fas fa-bars"></i> Menu
      </button>
      <button class="nav-btn" onclick="window.location.href='pages/tryon/index.html'" title="AI Try-On">AI Try-On</button>
    </div>
    
    <a href="/index.html" class="logo">REWEAVE</a>
    
    <div class="nav-right">
      <button class="nav-btn cart-btn" onclick="window.location.href = '/pages/cart/index.html'"">
        <i class="fas fa-shopping-bag"></i>
        <span class="cart-count" id="cartCount">0</span>
      </button>
    </div>
  </div>
</header>

<!-- Mobile Menu -->
<div class="mobile-menu" id="mobileMenu">
  <div class="menu-header">
    <h3>Menu</h3>
    <button class="nav-btn" onclick="toggleMenu()">
      <i class="fas fa-times"></i>
    </button>
  </div>
  
  <div class="menu-section">
    <div class="menu-title">Shop</div>
    <a href="pages/shop/index.html" class="menu-link">Shop All</a>
    <a href="pages/shop/index.html#new-arrivals" class="menu-link">New Arrivals</a>
    <a href="pages/shop/index.html#batik-heritage" class="menu-link">Batik Heritage</a>
    <a href="pages/shop/index.html#songket-collection" class="menu-link">Songket Collection</a>
    <a href="pages/shop/index.html#accessories" class="menu-link">Accessories</a>
  </div>
  
  <div class="menu-section">
    <div class="menu-title">Our Story</div>
    <a href="pages/story/index.html" class="menu-link">About Reweave</a>
    <a href="pages/artisan/index.html" class="menu-link">Artisan Craft</a>
    <a href="pages/culture/index.html" class="menu-link">Cultural Heritage</a>
    <a href="pages/impact/index.html" class="menu-link">Sustainability</a>
    <a href="pages/community/index.html" class="menu-link">Community</a>
  </div>
  
  <div class="menu-section">
    <div class="menu-title">Experience</div>
    <a href="pages/tryon/index.html" class="menu-link">AI Try-On</a>
    <a href="pages/customize/index.html" class="menu-link">Customize</a>
    <a href="pages/journal/index.html" class="menu-link">Journal</a>
  </div>
  
  <div class="menu-section">
    <div class="menu-title">Support</div>
    <a href="pages/team/index.html" class="menu-link">Contact Us</a>
    <a href="#" class="menu-link">Shipping & Returns</a>
    <a href="#" class="menu-link">Size Guide</a>
    <a href="#" class="menu-link">Care Instructions</a>
  </div>
</div>

  <main class="container" style="padding: 32px 16px;">
    <div id="detail" style="display:grid;grid-template-columns:1fr 1fr;gap:32px;align-items:start;">
      <div id="detail-image-wrap">
        <img id="detail-image" src="" alt="Product image" loading="lazy" decoding="async" style="width:100%;height:auto;border-radius:12px;object-fit:cover;" />
      </div>
      <div>
        <h1 id="detail-title" style="font-size:2rem;margin-bottom:8px;">Product</h1>
        <div id="detail-price" style="font-size:1.25rem;margin-bottom:12px;">RM 0.00</div>
        <div id="detail-material" style="color:#555;margin-bottom:12px;"></div>
        <div id="detail-sustain" style="color:#555;margin-bottom:16px;"></div>
        <p id="detail-desc" style="line-height:1.6;margin-bottom:16px;"></p>
        <div style="display:flex;gap:12px;">
          <a id="detail-tryon" href="../tryon/index.html" class="item-btn primary" style="display:inline-block;padding:10px 14px;border-radius:8px;background:#111;color:#fff;text-decoration:none;">AI Try-On</a>
          <button id="detail-add" class="item-btn secondary" style="display:inline-block;padding:10px 14px;border-radius:8px;background:#fff;color:#111;border:1px solid #e0e0e0;">Add to Bag</button>
          <button id="detail-buy" class="item-btn secondary" style="display:inline-block;padding:10px 14px;border-radius:8px;background:#fff;color:#111;border:1px solid #e0e0e0;">Buy Now</button>
        </div>
      </div>
    </div>
  </main>

  <!-- Standardized Footer Component for Reweave -->
<footer class="footer">
  <div class="container">
    <div class="footer-brand">REWEAVE</div>
    <div class="footer-text">
      Sustainable fashion, reimagined. Crafting heritage into modern essentials.
    </div>
    <div class="footer-links">
      <a href="pages/story/index.html" class="footer-link">Our Story</a>
      <a href="pages/impact/index.html" class="footer-link">Sustainability</a>
      <a href="pages/community/index.html" class="footer-link">Community</a>
      <a href="pages/team/index.html" class="footer-link">Contact</a>
    </div>
    <div class="footer-trust">
      <span class="trust-badge">FPX Available</span>
      <span class="trust-badge">Visa</span>
      <span class="trust-badge">Mastercard</span>
      <span class="trust-badge">30-day Returns</span>
    </div>
  </div>
</footer>

  <script>
    const API_PRODUCTS = '/api/products.json';
    const params = new URLSearchParams(window.location.search);
    const sku = params.get('sku');
    const getCart = () => JSON.parse(localStorage.getItem('cart') || '[]');
    const setCart = c => localStorage.setItem('cart', JSON.stringify(c));
    const formatMYR = v => `RM ${Number(v || 0).toFixed(2)}`;

    document.addEventListener('DOMContentLoaded', () => {
      fetch(API_PRODUCTS)
        .then(r => r.json())
        .then(data => {
          const list = Array.isArray(data) ? data : (data.products || []);
          let product = list.find(p => {
            const variants = p.variants || [];
            return (p.id === sku) || variants.some(v => v.sku === sku);
          }) || list[0];
          if (!product) return;
          const firstImage = (product.images && product.images[0]) || 'https://via.placeholder.com/800x800?text=Reweave';
          const minVariant = (product.variants || [])[0] || { price: product.price || 0, sku: product.id };
          const minPrice = (product.variants || []).reduce((m, v) => Math.min(m, Number(v.price || 0)), Number(minVariant.price || 0));

          const imgEl = document.getElementById('detail-image');
          imgEl.src = firstImage;
          imgEl.sizes = '(max-width: 768px) 100vw, 50vw';
          document.getElementById('detail-title').textContent = product.name || 'Product';
          document.getElementById('detail-price').textContent = formatMYR(minPrice);
          document.getElementById('detail-material').textContent = product.material ? `Material: ${product.material}` : '';
          document.getElementById('detail-sustain').textContent = product.sustainability ? `Impact: ${product.sustainability}` : '';
          document.getElementById('detail-desc').textContent = product.description || '';
      const tryon = document.getElementById('detail-tryon');
      tryon.href = `../tryon/index.html?product=${encodeURIComponent(product.name || '')}`;

      // Inject JSON-LD Product schema for AI shoppers
      const ld = {
        '@context': 'https://schema.org/',
        '@type': 'Product',
        name: product.name || 'Product',
        image: product.images || [firstImage],
        description: product.description || '',
        sku: minVariant.sku || product.id,
        brand: { '@type': 'Brand', name: 'Reweave' },
        category: (product.categories || []).join(', '),
        offers: {
          '@type': 'Offer',
          priceCurrency: 'MYR',
          price: Number(minPrice || 0),
          availability: 'https://schema.org/InStock'
        }
      };
      const breadcrumb = {
        '@context': 'https://schema.org',
        '@type': 'BreadcrumbList',
        itemListElement: [
          { '@type': 'ListItem', position: 1, name: 'Home', item: '/vercel-deployment/index.html' },
          { '@type': 'ListItem', position: 2, name: 'Shop', item: '/vercel-deployment/pages/shop/index.html' },
          { '@type': 'ListItem', position: 3, name: product.name || 'Product' }
        ]
      };
      const script = document.createElement('script');
      script.type = 'application/ld+json';
      script.textContent = JSON.stringify(ld);
      document.head.appendChild(script);
      const script2 = document.createElement('script');
      script2.type = 'application/ld+json';
      script2.textContent = JSON.stringify(breadcrumb);
      document.head.appendChild(script2);

          document.getElementById('detail-add').addEventListener('click', () => {
            const cart = getCart();
            const item = {
              id: minVariant.sku || product.id,
              name: product.name,
              price: Number(minVariant.price || minPrice),
              qty: 1,
              image: firstImage,
              options: '',
              addon: false
            };
            const existing = cart.find(i => i.id === item.id && i.options === item.options);
            if (existing) existing.qty += 1; else cart.push(item);
            setCart(cart);
            alert('Added to bag');
          });

          document.getElementById('detail-buy').addEventListener('click', () => {
            const cart = getCart();
            const item = {
              id: minVariant.sku || product.id,
              name: product.name,
              price: Number(minVariant.price || minPrice),
              qty: 1,
              image: firstImage,
              options: '',
              addon: false
            };
            const existing = cart.find(i => i.id === item.id && i.options === item.options);
            if (existing) existing.qty += 1; else cart.push(item);
            setCart(cart);
            window.location.href = '/pages/cart/index.html';
          });
        })
        .catch(err => {
          console.error(err);
        });
    });
  </script>

  <script src="/shared/script.js"></script>
</body>
</html>
