<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Reweave • Sustainable Fashion, Reimagined</title>
  <link rel="icon" type="image/png" href="images/Reweave_logo-removebg-preview.png" />
  <style>
    /* Luxury Design System Variables */
    :root {
      --primary-black: #111;
      --primary-white: #fff;
      --luxury-gray: #f8f8f8;
      --border-gray: #e5e5e5;
      --text-gray: #666;
      --accent-purple: #667eea;
      --font-serif: 'Playfair Display', serif;
      --font-sans: 'Montserrat', sans-serif;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: var(--font-sans);
      font-weight: 300;
      letter-spacing: 0.5px;
      color: var(--primary-black);
      background: var(--primary-white);
      line-height: 1.6;
    }

    /* Header */
    .header {
      position: fixed; top: 0; left: 0; right: 0;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid var(--border-gray);
      z-index: 1000;
      transition: all 0.3s ease;
    }
    
    .header-container {
      display: flex; align-items: center; justify-content: space-between;
      padding: 20px 30px; max-width: 1200px; margin: 0 auto;
    }
    
    .logo {
      font-family: var(--font-serif);
      font-size: 28px; font-weight: 300;
      letter-spacing: 2px; text-decoration: none;
      color: var(--primary-black);
    }
    
    .nav-left, .nav-right {
      display: flex; align-items: center; gap: 25px;
    }
    
    .nav-btn {
      background: none; border: none; cursor: pointer;
      font-family: var(--font-sans); font-weight: 300; font-size: 13px;
      display: flex; align-items: center; gap: 6px;
      transition: opacity 0.3s ease; color: var(--primary-black);
    }
    
    .nav-btn:hover { opacity: 0.7; }
    
    .cart-btn {
      position: relative; padding: 8px 16px;
      border: 1px solid var(--border-gray); border-radius: 20px;
      background: var(--primary-white);
    }
    
    .cart-count {
      position: absolute; top: -5px; right: -5px;
      background: var(--primary-black); color: var(--primary-white);
      border-radius: 50%; width: 18px; height: 18px;
      display: flex; align-items: center; justify-content: center;
      font-size: 10px; font-weight: 500;
    }

    /* Hero Section */
    .hero {
      padding: 140px 0 80px; min-height: 100vh;
      display: flex; align-items: center; justify-content: center;
      background: linear-gradient(135deg, var(--luxury-gray) 0%, var(--primary-white) 100%);
    }
    
    .hero-content {
      max-width: 1200px; margin: 0 auto; padding: 0 30px;
      display: grid; grid-template-columns: 1fr 1fr; gap: 60px;
      align-items: center;
    }
    
    .hero-text h1 {
      font-family: var(--font-serif); font-size: 3.5rem; font-weight: 300;
      line-height: 1.2; margin-bottom: 20px; letter-spacing: -1px;
    }
    
    .hero-text p {
      font-size: 1.2rem; color: var(--text-gray); margin-bottom: 30px;
      line-height: 1.7;
    }
    
    .hero-image img {
      width: 100%; border-radius: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.1);
    }

    /* Products Section */
    .products {
      padding: 80px 0; background: var(--primary-white);
    }
    
    .container {
      max-width: 1200px; margin: 0 auto; padding: 0 30px;
    }
    
    .section-title {
      font-family: var(--font-serif); font-size: 2.5rem; font-weight: 300;
      text-align: center; margin-bottom: 60px; letter-spacing: 1px;
    }
    
    .products-grid {
      display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 40px;
    }
    
    .product-card {
      background: var(--primary-white); border-radius: 16px;
      overflow: hidden; transition: all 0.3s ease;
      border: 1px solid var(--border-gray);
    }
    
    .product-card:hover {
      transform: translateY(-5px); box-shadow: 0 20px 40px rgba(0,0,0,0.1);
    }
    
    .product-image {
      width: 100%; height: 400px; object-fit: cover;
    }
    
    .product-info {
      padding: 24px;
    }
    
    .product-title {
      font-family: var(--font-serif); font-size: 1.5rem; font-weight: 300;
      margin-bottom: 8px; letter-spacing: 0.5px;
    }
    
    .product-price {
      font-size: 1.2rem; font-weight: 300; margin-bottom: 16px;
      color: var(--primary-black);
    }
    
    .product-options {
      display: flex; gap: 8px; margin-bottom: 20px;
    }
    
    .option-btn {
      padding: 6px 12px; border: 1px solid var(--border-gray);
      background: var(--primary-white); border-radius: 8px;
      font-size: 12px; cursor: pointer; transition: all 0.2s ease;
    }
    
    .option-btn:hover, .option-btn.active {
      border-color: var(--primary-black); background: var(--primary-black);
      color: var(--primary-white);
    }
    
    .product-actions {
      display: flex; gap: 12px;
    }
    
    .btn {
      padding: 12px 24px; border: 1px solid var(--primary-black);
      background: var(--primary-black); color: var(--primary-white);
      border-radius: 8px; font-family: var(--font-sans);
      font-weight: 300; letter-spacing: 0.5px; cursor: pointer;
      transition: all 0.3s ease; text-decoration: none; display: inline-block;
    }
    
    .btn:hover {
      background: var(--primary-white); color: var(--primary-black);
    }
    
    .btn-outline {
      background: var(--primary-white); color: var(--primary-black);
    }
    
    .btn-outline:hover {
      background: var(--primary-black); color: var(--primary-white);
    }

    /* Trust Section */
    .trust {
      padding: 60px 0; background: var(--luxury-gray);
      text-align: center;
    }
    
    .trust-badges {
      display: flex; justify-content: center; gap: 30px; flex-wrap: wrap;
    }
    
    .trust-badge {
      padding: 12px 20px; border: 1px solid var(--border-gray);
      border-radius: 20px; background: var(--primary-white);
      font-size: 13px; font-weight: 300;
    }

    /* Footer */
    .footer {
      padding: 40px 0; background: var(--primary-black); color: var(--primary-white);
      text-align: center;
    }
    
    .footer-brand {
      font-family: var(--font-serif); font-size: 24px; font-weight: 300;
      letter-spacing: 2px; margin-bottom: 10px;
    }
    
    .footer-text {
      font-size: 14px; opacity: 0.7; font-weight: 300;
    }

    /* Toast Notifications */
    .toast {
      position: fixed;
      top: 100px;
      right: 20px;
      background: var(--primary-black);
      color: var(--primary-white);
      padding: 16px 24px;
      border-radius: 8px;
      font-family: var(--font-sans);
      font-size: 14px;
      font-weight: 300;
      z-index: 10000;
      transform: translateX(400px);
      transition: transform 0.3s ease;
      box-shadow: 0 4px 20px rgba(0,0,0,0.15);
    }
    
    .toast.show {
      transform: translateX(0);
    }
    
    .toast.success {
      background: #2e7d32;
    }
    
    .toast.error {
      background: #d32f2f;
    }

    /* Mobile Menu */
    .mobile-menu {
      position: fixed; top: 0; left: -100%; width: 320px; height: 100vh;
      background: var(--primary-white); border-right: 1px solid var(--border-gray);
      z-index: 1001; transition: left 0.3s ease; overflow-y: auto;
    }
    
    .mobile-menu.active { left: 0; }
    
    .menu-header {
      padding: 20px; border-bottom: 1px solid var(--border-gray);
      display: flex; justify-content: space-between; align-items: center;
    }
    
    .menu-section {
      padding: 20px; border-bottom: 1px solid var(--border-gray);
    }
    
    .menu-title {
      font-family: var(--font-serif); font-size: 16px; font-weight: 300;
      margin-bottom: 15px; letter-spacing: 1px;
    }
    
    .menu-link {
      display: block; padding: 8px 0; color: var(--text-gray);
      text-decoration: none; font-size: 14px; transition: color 0.3s ease;
    }
    
    .menu-link:hover { color: var(--primary-black); }

    /* Responsive */
    @media (max-width: 768px) {
      .hero-content {
        grid-template-columns: 1fr; text-align: center; gap: 40px;
      }
      
      .hero-text h1 { font-size: 2.5rem; }
      
      .products-grid {
        grid-template-columns: 1fr;
      }
      
      .trust-badges {
        gap: 15px;
      }
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="header-container">
      <div class="nav-left">
        <button class="nav-btn" onclick="toggleMenu()">
          <i class="fas fa-bars"></i> Menu
        </button>

      </div>
      
      <a href="/" class="logo">REWEAVE</a>
      
      <div class="nav-right">
        <button class="nav-btn" onclick="window.location.href='pages/account/index.html'">
          <i class="fas fa-user"></i>
        </button>
        <button class="nav-btn cart-btn" onclick="window.location.href='cart.html'">
          <i class="fas fa-shopping-bag"></i>
          <span class="cart-count" id="cartCount">0</span>
        </button>
      </div>
    </div>
  </header>

  <!-- Mobile Menu -->
  <div class="mobile-menu" id="mobileMenu">
    <div class="menu-header">
      <h3>Menu</h3>
      <button class="nav-btn" onclick="toggleMenu()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    
    <div class="menu-section">
      <div class="menu-title">Shop</div>
      <a href="#" class="menu-link">New Arrivals</a>
      <a href="#" class="menu-link">Batik Heritage</a>
      <a href="#" class="menu-link">Songket Collection</a>
      <a href="#" class="menu-link">Accessories</a>
    </div>
    
    <div class="menu-section">
      <div class="menu-title">Our Story</div>
      <a href="#" class="menu-link">About Reweave</a>
      <a href="#" class="menu-link">Artisan Craft</a>
      <a href="#" class="menu-link">Sustainability</a>
      <a href="#" class="menu-link">Community</a>
    </div>
    
    <div class="menu-section">
      <div class="menu-title">Support</div>
      <a href="#" class="menu-link">Contact Us</a>
      <a href="#" class="menu-link">Shipping & Returns</a>
      <a href="#" class="menu-link">Size Guide</a>
    </div>
  </div>

  <!-- Hero Section -->
  <section class="hero">
    <div class="hero-content">
      <div class="hero-text">
        <h1>Crafted essentials for modern life</h1>
        <p>Curated silhouettes in heritage Songket and Batik. Handwoven craft meets daily utility.</p>
        <div class="hero-actions">
          <a href="#products" class="btn">Shop Now</a>
          <a href="#story" class="btn btn-outline">Our Story</a>
        </div>
        <div class="trust-badges" style="margin-top: 30px;">
          <span class="trust-badge">FPX Available</span>
          <span class="trust-badge">Visa</span>
          <span class="trust-badge">Mastercard</span>
          <span class="trust-badge">30-day Returns</span>
        </div>
      </div>
      <div class="hero-image">
        <img src="images/Batik Front (WIP).png" alt="Reweave Heritage Collection" />
      </div>
    </div>
  </section>

  <!-- Products Section -->
  <section class="products" id="products">
    <div class="container">
      <h2 class="section-title">Shop the Collection</h2>
      
      <div class="products-grid" id="productsGrid">
        <!-- Products will be loaded dynamically from Supabase -->
      </div>
    </div>
  </section>

  <!-- Trust Section -->
  <section class="trust">
    <div class="container">
      <div class="trust-badges">
        <span class="trust-badge">Free Shipping Above RM150</span>
        <span class="trust-badge">30-Day Returns</span>
        <span class="trust-badge">Handcrafted Quality</span>
        <span class="trust-badge">Sustainable Materials</span>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="footer-brand">REWEAVE</div>
      <div class="footer-text">
        FPX, Visa, Mastercard, Apple Pay • 30-day returns • Support: +65 6123 4567
      </div>
    </div>
  </footer>

  <!-- JavaScript -->
  <script src="https://kit.fontawesome.com/your-fontawesome-kit.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    // Supabase configuration
    const supabaseUrl = 'https://dkpaeiyixdwzjpvvszyy.supabase.co';
    const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRrcGFlaXlpeGR3empwdnZzenl5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM1MjAyNTUsImV4cCI6MjA3OTA5NjI1NX0.tcESQl8N7gFFkzh-OOvRBnHFyJ2CC9W0-vs3e6ItZTc';
    const supabaseClient = supabase.createClient(supabaseUrl, supabaseKey);

    // Cart functionality
    let cart = JSON.parse(localStorage.getItem('reweave-cart')) || [];
    let products = [];
    
    function updateCartCount() {
      document.getElementById('cartCount').textContent = cart.length;
    }
    
    function addToCart(variantId) {
      // Find the variant across all products
      let selectedVariant = null;
      for (const product of products) {
        const variant = product.variants.find(v => v.id === variantId);
        if (variant) {
          selectedVariant = variant;
          break;
        }
      }
      
      if (selectedVariant) {
        cart.push({
          id: variantId,
          name: selectedVariant.variant_name,
          price: selectedVariant.price,
          color: selectedVariant.color,
          image: selectedVariant.image,
          qty: 1,
          variant: selectedVariant.color,
          timestamp: Date.now()
        });
        
        localStorage.setItem('reweave-cart', JSON.stringify(cart));
        updateCartCount();
        
        // Show toast notification
        showToast('Added to cart!', 'success');
      }
    }
    
    function toggleMenu() {
      const mobileMenu = document.getElementById('mobileMenu');
      mobileMenu.classList.toggle('active');
      
      // Add overlay when menu is open
      if (mobileMenu.classList.contains('active')) {
        createOverlay();
      } else {
        removeOverlay();
      }
    }
    
    function createOverlay() {
      const overlay = document.createElement('div');
      overlay.id = 'menuOverlay';
      overlay.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.5);
        z-index: 1000;
        cursor: pointer;
      `;
      overlay.onclick = closeMenu;
      document.body.appendChild(overlay);
    }
    
    function removeOverlay() {
      const overlay = document.getElementById('menuOverlay');
      if (overlay) {
        overlay.remove();
      }
    }
    
    function closeMenu() {
      document.getElementById('mobileMenu').classList.remove('active');
      removeOverlay();
    }
    
    // Fetch product variants from Supabase
    async function fetchProducts() {
      try {
        const { data, error } = await supabaseClient
          .from('product_variants')
          .select('*, products(title, description, category)')
          .eq('is_active', true)
          .order('product_id');
        
        if (error) {
          console.error('Error fetching product variants:', error);
          return;
        }
        
        // Group variants by product
        const groupedProducts = {};
        data.forEach(variant => {
          if (!groupedProducts[variant.product_id]) {
            groupedProducts[variant.product_id] = {
              id: variant.product_id,
              title: variant.products.title,
              description: variant.products.description,
              category: variant.products.category,
              variants: []
            };
          }
          groupedProducts[variant.product_id].variants.push(variant);
        });
        
        products = Object.values(groupedProducts);
        renderProducts(products);
      } catch (error) {
        console.error('Error fetching product variants:', error);
      }
    }
    
    // Render products with variants
    function renderProducts(productsData) {
      const productsGrid = document.getElementById('productsGrid');
      productsGrid.innerHTML = '';
      
      productsData.forEach(product => {
        if (product.variants.length === 0) return;
        
        const productCard = document.createElement('div');
        productCard.className = 'product-card';
        productCard.dataset.productId = product.id;
        
        // Use first variant as default display
        const defaultVariant = product.variants[0];
        
        // Create color options from variants
        const colorOptions = product.variants.map((variant, index) => 
          `<button class="option-btn ${index === 0 ? 'active' : ''}" 
                   onclick="selectVariant('${product.id}', '${variant.id}', this)"
                   data-variant-id="${variant.id}">
            ${variant.color}
          </button>`
        ).join('');
        
        productCard.innerHTML = `
          <img src="${defaultVariant.image}" 
               alt="${defaultVariant.variant_name}" 
               class="product-image" 
               id="image-${product.id}">
          <div class="product-info">
            <h3 class="product-title" id="title-${product.id}">${defaultVariant.variant_name}</h3>
            <div class="product-price" id="price-${product.id}">${defaultVariant.price}</div>
            <div class="product-options" id="options-${product.id}">
              ${colorOptions}
            </div>
            <div class="product-actions">
              <button class="btn" onclick="addToCart('${defaultVariant.id}')" id="cart-${product.id}">Add to Cart</button>
              <button class="btn btn-outline">Buy Now</button>
            </div>
          </div>
        `;
        
        productsGrid.appendChild(productCard);
      });
    }
    
    // Handle variant selection
    function selectVariant(productId, variantId, button) {
      // Update active state
      const productCard = button.closest('.product-card');
      productCard.querySelectorAll('.option-btn').forEach(btn => btn.classList.remove('active'));
      button.classList.add('active');
      
      // Find the variant data
      const product = products.find(p => p.id === productId);
      const variant = product.variants.find(v => v.id === variantId);
      
      if (variant) {
        // Update display
        document.getElementById(`image-${productId}`).src = variant.image;
        document.getElementById(`title-${productId}`).textContent = variant.variant_name;
        document.getElementById(`price-${productId}`).textContent = variant.price;
        document.getElementById(`cart-${productId}`).onclick = () => addToCart(variant.id);
      }
    }
    
    // Initialize
    updateCartCount();
    fetchProducts();
    
    // Add event listeners to close menu when clicking links
    document.querySelectorAll('.menu-link').forEach(link => {
      link.addEventListener('click', closeMenu);
    });
    
    // Close menu when window is resized to desktop size
    window.addEventListener('resize', function() {
      if (window.innerWidth > 768) {
        closeMenu();
      }
    });
    
    // Close menu on escape key
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        closeMenu();
      }
    });
    
    // Smooth scrolling for anchor links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
          target.scrollIntoView({ behavior: 'smooth' });
        }
      });
    });
    
    // Header scroll effect
    window.addEventListener('scroll', function() {
      const header = document.querySelector('.header');
      if (window.scrollY > 100) {
        header.style.background = 'rgba(255, 255, 255, 0.98)';
        header.style.boxShadow = '0 2px 20px rgba(0,0,0,0.1)';
      } else {
        header.style.background = 'rgba(255, 255, 255, 0.95)';
        header.style.boxShadow = 'none';
      }
    });
  </script>
  
  <!-- Toast Notification Container -->
  <div id="toastContainer" style="position: fixed; top: 100px; right: 20px; z-index: 10000;"></div>
  
  <!-- Toast Notification Script -->
  <script>
    // Toast notification system
    function showToast(message, type = 'info', duration = 3000) {
      const container = document.getElementById('toastContainer');
      const toast = document.createElement('div');
      toast.className = `toast ${type}`;
      toast.textContent = message;
      
      container.appendChild(toast);
      
      // Trigger animation
      setTimeout(() => toast.classList.add('show'), 10);
      
      // Remove after duration
      setTimeout(() => {
        toast.classList.remove('show');
        setTimeout(() => toast.remove(), 300);
      }, duration);
    }
    
    // Override alert function to use toast
    window.alert = function(message) {
      showToast(message, 'success');
    };
  </script>
  
  <!-- AI Chatbot Widget -->
  <script id="shieldbase-chatbot-widget">(function(){window.SbaiConfig={apiBase:"https://demo.sbai.cloud",appId:"ca61bc90-3fb9-4cde-a7ed-aef28d127c1a"};function initChatWidget(){if(document.getElementById('sbai-chat-btn'))return;var chatBtn=document.createElement("div");chatBtn.id="sbai-chat-btn";chatBtn.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="23" height="23" viewBox="0 0 16 16" fill="white"><path d="M8.006 0a8.006 8.006 0 0 0-6.829 3.826 7.995 7.995 0 0 0-.295 7.818l-.804 2.402a1.48 1.48 0 0 0 1.877 1.876l2.403-.8a8.006 8.006 0 0 0 11.42-5.25 7.994 7.994 0 0 0-4.28-9.066A8.007 8.007 0 0 0 8.006 0Zm0 14.22a6.226 6.226 0 0 1-3.116-.836.89.89 0 0 0-.727-.074l-2.207.736.736-2.206a.888.888 0 0 0-.074-.727A6.218 6.218 0 0 1 7.19 1.831a6.227 6.227 0 0 1 6.565 3.784 6.218 6.218 0 0 1-1.96 7.318 6.227 6.227 0 0 1-3.789 1.286Z"></path></svg>';Object.assign(chatBtn.style,{position:"fixed",bottom:"20px",right:"20px",width:"60px",height:"60px",borderRadius:"50%",backgroundColor:"#4F00ED",display:"flex",justifyContent:"center",alignItems:"center",color:"white",fontSize:"24px",cursor:"pointer",zIndex:"9999",transition:"all 0.3s ease",boxShadow:"0 4px 12px rgba(79, 0, 237, 0.4)",border:"none"});var chatContainer=document.createElement("div");chatContainer.id="sbai-chat-container";Object.assign(chatContainer.style,{position:"fixed",right:"20px",bottom:"90px",width:"400px",height:"600px",maxWidth:"calc(100vw - 40px)",maxHeight:"calc(100vh - 120px)",borderRadius:"16px",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.12)",zIndex:"9998",opacity:"0",visibility:"hidden",transform:"translateY(20px)",transition:"all 0.3s ease",backgroundColor:"white",overflow:"hidden"});document.body.appendChild(chatBtn);document.body.appendChild(chatContainer);var isOpen=false;chatBtn.addEventListener("click",function(){isOpen=!isOpen;if(isOpen){chatContainer.style.opacity="1";chatContainer.style.visibility="visible";chatContainer.style.transform="translateY(0)";chatBtn.style.transform="rotate(45deg)";if(!chatContainer.querySelector("iframe")){var iframe=document.createElement("iframe");iframe.src=window.SbaiConfig.apiBase+"/chat/"+window.SbaiConfig.appId;iframe.style.width="100%";iframe.style.height="100%";iframe.style.border="none";iframe.style.borderRadius="16px";iframe.allow="microphone; camera";chatContainer.appendChild(iframe);}}else{chatContainer.style.opacity="0";chatContainer.style.visibility="hidden";chatContainer.style.transform="translateY(20px)";chatBtn.style.transform="rotate(0deg)";}});document.addEventListener("click",function(e){if(isOpen&&!chatBtn.contains(e.target)&&!chatContainer.contains(e.target)){isOpen=false;chatContainer.style.opacity="0";chatContainer.style.visibility="hidden";chatContainer.style.transform="translateY(20px)";chatBtn.style.transform="rotate(0deg)";}});}if(document.readyState==="loading"){document.addEventListener("DOMContentLoaded",initChatWidget);}else{initChatWidget();}})();
  </script>
</body>
</html>